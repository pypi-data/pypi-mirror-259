[build-system]
requires = [
    "pdm-backend",
]
build-backend = "pdm.backend"

[tool.pdm.version]
source = "scm"

[tool.pdm.scripts]
format = "pdm run ruff format . --check"
lint = "pdm run ruff check . --fix"
typecheck = "mypy ."
test = "pdm run pytest tests/ -v --cov src/get_py_deps --cov-report term --cov-report html"
pipeline-test = "pdm run pytest tests/ --cov get_py_deps --cov-report xml --cov-report html --junitxml junit/test-results.xml --no-coverage-upload"

[tool.pdm.scripts.all]
composite = [
    "format",
    "lint",
    "test",
    "typecheck",
]

[tool.pytest.ini_options]
log_cli = true
log_cli_level = "INFO"
log_cli_format = "%(asctime)s [%(levelname)8s] %(message)s (%(filename)s:%(lineno)s)"
log_cli_date_format = "%Y-%m-%d %H:%M:%S"

[tool.ruff]
src = [
    "src",
]

[tool.ruff.lint]
select = [
    "E",
    "F",
    "UP",
    "B",
    "SIM",
    "I",
]

[tool.ruff.lint.extend-per-file-ignores]
"tests/**" = [
    "S101",
    "D103",
]
"**/__init__.py" = [
    "F401",
    "F403",
]
"docs/**" = [
    "INP001",
]

[tool.mypy]
disallow_untyped_defs = true
warn_unused_ignores = true
exclude = [
    ".venv/",
    "dist/",
    "tests/",
]

[tool.coverage.run]
omit = [
    "*tests*",
]

[project]
name = "get-py-deps"
description = ""
readme = "README.md"
requires-python = ">=3.9"
dependencies = [
    "prettytable~=3.10.0",
    "setuptools~=69.1.1",
]
dynamic = []
version = "2.0.0"

[project.optional-dependencies]
lint = [
    "ruff~=0.2.1",
    "mypy~=1.8.0",
    "types-setuptools>=69.1.0.20240229",
]
test = [
    "pytest~=8.0.0",
    "pytest-cov~=4.1.0",
    "coverage[toml]~=7.4.1",
]
dev = [
    "tox~=4.12.1",
    "tox-pdm~=0.7.2",
    "pre-commit~=3.6.1",
    "get-py-deps[lint]",
    "get-py-deps[test]",
]

[project.scripts]
get-py-deps = "get_py_deps.main:_cli"

[project.urls]
Repository = "https://github.com/Wesztman/get-py-deps"
