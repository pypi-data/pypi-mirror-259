"use strict";(self.webpackChunk_jupytercad_jupytercad_core=self.webpackChunk_jupytercad_jupytercad_core||[]).push([[621],{6621:(e,t,r)=>{r.r(t),r.d(t,{JupyterCadWidgetFactory:()=>l,JupyterCadWorkerRegistry:()=>x,default:()=>k});var i=r(4796),n=r(8217),o=r(5922),a=r(3665),s=r(5591),p=r(4388),d=r(815),c=r(9905);class l extends d.ABCWidgetFactory{constructor(e){const{backendCheck:t,externalCommandRegistry:r}=e;super(function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(e,["backendCheck","externalCommandRegistry"])),this._backendCheck=t,this._commands=e.commands,this._workerRegistry=e.workerRegistry,this._externalCommandRegistry=r}createNewWidget(e){if(this._backendCheck&&!this._backendCheck())throw new Error("Requested backend is not installed");const{model:t}=e,r=new c.JupyterCadPanel({model:t,workerRegistry:this._workerRegistry}),i=new c.ToolbarWidget({commands:this._commands,model:t,externalCommands:this._externalCommandRegistry.getCommands()});return new c.JupyterCadWidget({context:e,content:r,toolbar:i})}}class y{constructor(e){this.collaborative=!0,this._disposed=!1,this._annotationModel=e.annotationModel}get name(){return"jupytercad-jcadmodel"}get contentType(){return"jcad"}get fileFormat(){return"text"}get isDisposed(){return this._disposed}dispose(){this._disposed=!0}preferredLanguage(e){return""}createNew(e){return new n.JupyterCadModel({sharedModel:e.sharedModel,languagePreference:e.languagePreference,annotationModel:this._annotationModel})}}const m="JupyterCAD .jcad Viewer";var u;!function(e){e.createNew="jupytercad:create-new-jcad-file"}(u||(u={}));const h={id:"jupytercad:jcadplugin",requires:[n.IJupyterCadDocTracker,o.IThemeManager,n.IAnnotationToken,a.IFileBrowserFactory,i.ICollaborativeDrive,n.IJCadWorkerRegistryToken,n.IJCadExternalCommandRegistryToken],optional:[s.ILauncher,o.ICommandPalette],autoStart:!0,activate:(e,t,r,i,o,a,s,d,c,h)=>{const g=new l({name:m,modelName:"jupytercad-jcadmodel",fileTypes:["jcad"],defaultFor:["jcad"],tracker:t,commands:e.commands,workerRegistry:s,externalCommandRegistry:d});e.docRegistry.addWidgetFactory(g);const P=new y({annotationModel:i});e.docRegistry.addModelFactory(P),e.docRegistry.addFileType({name:"jcad",displayName:"JCAD",mimeTypes:["text/json"],extensions:[".jcad",".JCAD"],fileFormat:"text",contentType:"jcad"}),a.sharedModelFactory.registerDocumentFactory("jcad",(()=>new n.JupyterCadDoc)),g.widgetCreated.connect(((i,n)=>{n.context.pathChanged.connect((()=>{t.save(n)})),r.themeChanged.connect(((e,t)=>n.context.model.themeChanged.emit(t))),t.add(n),e.shell.activateById("jupytercad::leftControlPanel"),e.shell.activateById("jupytercad::rightControlPanel")})),e.commands.addCommand(u.createNew,{label:e=>"New JCAD File",caption:"Create a new JCAD Editor",icon:e=>e.isPalette?void 0:p.fileIcon,execute:async t=>{var r;const i=t.cwd||(null===(r=o.tracker.currentWidget)||void 0===r?void 0:r.model.path);let n=await e.serviceManager.contents.newUntitled({path:i,type:"file",ext:".jcad"});return n=await e.serviceManager.contents.save(n.path,Object.assign(Object.assign({},n),{format:"text",size:void 0,content:'{\n\t"objects": [],\n\t"options": {},\n\t"metadata": {},\n\t"outputs": {}}'})),e.commands.execute("docmanager:open",{path:n.path,factory:m})}}),c&&c.add({command:u.createNew,category:"Other",rank:1}),h&&h.addItem({command:u.createNew,args:{isPalette:!0},category:"JupyterCAD"})}};class g{constructor(){this.collaborative=!0,this._disposed=!1}get name(){return"jupytercad-stepmodel"}get contentType(){return"step"}get fileFormat(){return"text"}get isDisposed(){return this._disposed}dispose(){this._disposed=!0}preferredLanguage(e){return""}createNew(e){return new n.JupyterCadModel({sharedModel:e.sharedModel,languagePreference:e.languagePreference})}}const P={id:"jupytercad:stepplugin",requires:[n.IJupyterCadDocTracker,o.IThemeManager,i.ICollaborativeDrive,n.IJCadWorkerRegistryToken,n.IJCadExternalCommandRegistryToken],autoStart:!0,activate:(e,t,r,i,o,a)=>{const s=new l({name:"JupyterCAD STEP Viewer",modelName:"jupytercad-stepmodel",fileTypes:["step"],defaultFor:["step"],tracker:t,commands:e.commands,workerRegistry:o,externalCommandRegistry:a});e.docRegistry.addWidgetFactory(s);const p=new g;e.docRegistry.addModelFactory(p),e.docRegistry.addFileType({name:"step",displayName:"STEP",mimeTypes:["text/json"],extensions:[".step",".STEP"],fileFormat:"text",contentType:"step"}),i.sharedModelFactory.registerDocumentFactory("step",(()=>new n.JupyterCadStepDoc)),s.widgetCreated.connect(((i,n)=>{n.context.pathChanged.connect((()=>{t.save(n)})),r.themeChanged.connect(((e,t)=>n.context.model.themeChanged.emit(t))),t.add(n),e.shell.activateById("jupytercad::leftControlPanel"),e.shell.activateById("jupytercad::rightControlPanel")}))}};var b=r(5953),f=r(2246),A=r(259);class x{constructor(){this._registry=new Map;const e=new Worker(new URL(r.p+r.u(201),r.b));this._defaultWorker=new A.OccWorker({worker:e})}registerWorker(e,t){this._registry.has(e)?console.error("Worker is already registered!"):this._registry.set(e,t)}unregisterWorker(e){this._registry.has(e)||this._registry.delete(e)}getDefaultWorker(){return this._defaultWorker}getWorker(e){return this._registry.get(e)}getAllWorkers(){return[...this._registry.values()]}}const C=JSON.parse('{"Part::GeomCircle":{"type":"object","required":["TypeId","CenterX","CenterY","CenterZ","NormalX","NormalY","NormalZ","AngleXU","Radius"],"additionalProperties":false,"properties":{"TypeId":{"const":"Part::GeomCircle","description":"Geometry type"},"CenterX":{"type":"number","description":"CenterX"},"CenterY":{"type":"number","description":"CenterY"},"CenterZ":{"type":"number","description":"CenterZ"},"NormalX":{"type":"number","description":"NormalX"},"NormalY":{"type":"number","description":"NormalY"},"NormalZ":{"type":"number","description":"NormalZ"},"AngleXU":{"type":"number","description":"AngleXU"},"Radius":{"type":"number","description":"Radius"}}},"Part::GeomLineSegment":{"type":"object","required":["TypeId","StartX","StartY","StartZ","EndX","EndY","EndZ"],"additionalProperties":false,"properties":{"TypeId":{"const":"Part::GeomLineSegment","description":"Geometry type"},"StartX":{"type":"number","description":"StartX"},"StartY":{"type":"number","description":"StartY"},"StartZ":{"type":"number","description":"StartZ"},"EndX":{"type":"number","description":"EndX"},"EndY":{"type":"number","description":"EndY"},"EndZ":{"type":"number","description":"EndZ"}}},"Placement of the box":{"type":"object","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}},"Post::Operator":{"type":"object","required":["Object"],"additionalProperties":true,"properties":{"Object":{"type":"string","description":"The name of input object"}}},"Part::Any":{"type":"object","required":["Content","Type"],"additionalProperties":false,"properties":{"Content":{"type":"string","description":"The string content of the object"},"Type":{"type":"string","enum":["brep","step"]},"Placement":{"type":"object","description":"Placement of the box","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}}}},"Part::Cone":{"type":"object","required":["Radius1","Radius2","Height","Angle","Placement"],"additionalProperties":false,"properties":{"Radius1":{"type":"number","description":"The bottom radius of the cone"},"Radius2":{"type":"number","description":"The top radius of the cone"},"Height":{"type":"number","description":"The height of the cone"},"Angle":{"type":"number","description":"The angle of the cone"},"Placement":{"type":"object","description":"Placement of the box","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}}}},"Part::Box":{"type":"object","required":["Length","Width","Height","Placement"],"additionalProperties":false,"properties":{"Length":{"type":"number","description":"The length of the box"},"Width":{"type":"number","description":"The width of the box"},"Height":{"type":"number","description":"The height of the box"},"Placement":{"type":"object","description":"Placement of the box","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}}}},"Part::Cylinder":{"type":"object","required":["Radius","Angle","Height","Placement"],"additionalProperties":false,"properties":{"Radius":{"type":"number","description":"Radius of the cylinder"},"Height":{"type":"number","description":"Height of the cylinder"},"Angle":{"type":"number","description":"Angle of the cylinder"},"Placement":{"type":"object","description":"Placement of the box","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}}}},"Part::Extrusion":{"type":"object","required":["Base","Dir","LengthFwd","LengthRev","Solid","Placement"],"additionalProperties":false,"properties":{"Base":{"type":"string","description":"Shape to extrude","fcType":"App::PropertyLink"},"Dir":{"type":"array","description":"Direction of extrusion","items":{"type":"number"}},"LengthFwd":{"type":"number","description":"Length of extrusion along the direction"},"LengthRev":{"type":"number","description":"Length of extrusion against the direction"},"Solid":{"type":"boolean","description":"If true, creating a solid"},"Placement":{"type":"object","description":"Placement of the box","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}}}},"Part::MultiFuse":{"type":"object","required":["Shapes","Refine","Placement"],"additionalProperties":false,"properties":{"Shapes":{"type":"array","description":"The shapes of the individual elements","fcType":"App::PropertyLinkList","items":{"type":"string"}},"Refine":{"type":"boolean","description":"Refine shape"},"Placement":{"type":"object","description":"Placement of the box","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}}}},"Part::MultiCommon":{"type":"object","required":["Shapes","Refine","Placement"],"additionalProperties":false,"properties":{"Shapes":{"type":"array","description":"The objects to intersect","fcType":"App::PropertyLinkList","items":{"type":"string"}},"Refine":{"type":"boolean","description":"Refine shape"},"Placement":{"type":"object","description":"Placement of the box","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}}}},"Sketcher::SketchObject":{"type":"object","required":["AttachmentOffset","Geometry"],"additionalProperties":false,"properties":{"AttachmentOffset":{"description":"The attachment offset","type":"object","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}},"Geometry":{"type":"array","description":"The geometry list","items":{"anyOf":[{"type":"object","description":"Part::GeomCircle","title":"IGeomCircle","required":["TypeId","CenterX","CenterY","CenterZ","NormalX","NormalY","NormalZ","AngleXU","Radius"],"additionalProperties":false,"properties":{"TypeId":{"const":"Part::GeomCircle","description":"Geometry type"},"CenterX":{"type":"number","description":"CenterX"},"CenterY":{"type":"number","description":"CenterY"},"CenterZ":{"type":"number","description":"CenterZ"},"NormalX":{"type":"number","description":"NormalX"},"NormalY":{"type":"number","description":"NormalY"},"NormalZ":{"type":"number","description":"NormalZ"},"AngleXU":{"type":"number","description":"AngleXU"},"Radius":{"type":"number","description":"Radius"}}},{"type":"object","description":"Part::GeomLineSegment","title":"IGeomLineSegment","required":["TypeId","StartX","StartY","StartZ","EndX","EndY","EndZ"],"additionalProperties":false,"properties":{"TypeId":{"const":"Part::GeomLineSegment","description":"Geometry type"},"StartX":{"type":"number","description":"StartX"},"StartY":{"type":"number","description":"StartY"},"StartZ":{"type":"number","description":"StartZ"},"EndX":{"type":"number","description":"EndX"},"EndY":{"type":"number","description":"EndY"},"EndZ":{"type":"number","description":"EndZ"}}}]}},"Placement":{"type":"object","description":"Placement of the box","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}}}},"Part::Sphere":{"type":"object","required":["Radius","Angle1","Angle2","Angle3","Placement"],"additionalProperties":false,"properties":{"Radius":{"type":"number","description":"The radius of the sphere"},"Angle1":{"type":"number","description":"The angle of the sphere"},"Angle2":{"type":"number","description":"The angle of the sphere"},"Angle3":{"type":"number","description":"The angle of the sphere"},"Placement":{"type":"object","description":"Placement of the box","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}}}},"Part::Cut":{"type":"object","required":["Base","Tool","Refine","Placement"],"additionalProperties":false,"properties":{"Base":{"type":"string","description":"The base of the cut operator","fcType":"App::PropertyLink"},"Tool":{"type":"string","description":"The tool of the cut operator","fcType":"App::PropertyLink"},"Refine":{"type":"boolean","description":"Refine shape"},"Placement":{"type":"object","description":"Placement of the box","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}}}},"Part::Torus":{"type":"object","required":["Radius1","Radius2","Angle1","Angle2","Angle3","Placement"],"additionalProperties":false,"properties":{"Radius1":{"type":"number","description":"The radius of the torus"},"Radius2":{"type":"number","description":"The radius of the torus"},"Angle1":{"type":"number","description":"The angle of the torus"},"Angle2":{"type":"number","description":"The angle of the torus"},"Angle3":{"type":"number","description":"The angle of the torus"},"Placement":{"type":"object","description":"Placement of the box","additionalProperties":false,"required":["Position","Axis","Angle"],"properties":{"Position":{"type":"array","description":"Position of the Placement","items":{"type":"number"}},"Axis":{"type":"array","description":"Axis of the Placement","items":{"type":"number"}},"Angle":{"type":"number","description":"Angle of the Placement"}}}}}}');class j{constructor(){this._registry=new Map(Object.entries(C))}registerSchema(e,t){this._registry.has(e)?console.error("Worker is already registered!"):this._registry.set(e,t)}has(e){return this._registry.has(e)}getSchemas(){return this._registry}}class T{constructor(){this._registry=new Set}registerCommand(e){this._registry.add(e)}getCommands(){return[...this._registry]}}const k=[{id:"jupytercad:core:tracker",autoStart:!0,requires:[f.ITranslator],optional:[b.IMainMenu],provides:n.IJupyterCadDocTracker,activate:(e,t,r)=>{const i=new o.WidgetTracker({namespace:"jupytercad"});return console.log("jupytercad:core:tracker is activated!"),i}},{id:"jupytercad:core:annotation",autoStart:!0,requires:[n.IJupyterCadDocTracker],provides:n.IAnnotationToken,activate:(e,t)=>{var r;const i=new c.AnnotationModel({context:null===(r=t.currentWidget)||void 0===r?void 0:r.context});return t.currentChanged.connect(((e,t)=>{i.context=(null==t?void 0:t.context)||void 0})),i}},{id:"jupytercad:core:worker-registry",autoStart:!0,requires:[],provides:n.IJCadWorkerRegistryToken,activate:e=>new x},h,P,{id:"jupytercad:core:form-schema-registry",autoStart:!0,requires:[],provides:n.IJCadFormSchemaRegistryToken,activate:e=>new j},{id:"jupytercad:core:external-command-registry",autoStart:!0,requires:[],provides:n.IJCadExternalCommandRegistryToken,activate:e=>new T}]}}]);