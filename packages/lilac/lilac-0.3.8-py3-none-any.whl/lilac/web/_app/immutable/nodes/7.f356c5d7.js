import{a8 as At,am as Ot,aj as zt,S as Xe,i as Qe,s as We,k as d,q as A,a as C,y as K,l as p,m as h,r as O,h as o,c as F,z as L,n as f,b as T,U as u,A as M,u as he,g as x,d as S,B as U,H as Ye,I as Tt,ag as Re,Y as Be,an as Fe,v as Ee,f as Ie,a4 as Gt,Z as Kt,p as qe,V as P,aa as Nt,_ as bt,a9 as Lt,w as Mt,J as Ut,K as Bt}from"../chunks/index.cbae6e09.js";import{E as $t,D as Jt}from"../chunks/DatasetFieldEmbeddingSelector.36a37ffc.js";import{P as jt}from"../chunks/Page.c8a3df22.js";import{w as Ht}from"../chunks/paths.1d8f20b3.js";import{bG as wt,O as kt,F as Xt,J as Qt,K as Wt,L as Yt,a_ as Rt,d as Pe,c as Zt,bc as es,R as ts,be as ss,bf as ls,bA as as}from"../chunks/Modal.54eb1296.js";import{T as rs,c as Ce}from"../chunks/colors.051b4cfc.js";import{S as ns}from"../chunks/Search.2e31d599.js";class qt{static retrieval(e){return wt(kt,{method:"POST",url:"/api/v1/rag/retrieval",body:e,mediaType:"application/json",errors:{422:"Validation Error"}})}static generate(e){return wt(kt,{method:"POST",url:"/api/v1/rag/generate",body:e,mediaType:"application/json",errors:{422:"Validation Error"}})}}const Je="RAG_VIEW_CONTEXT",Ct="{query_str}",je="{context_str}";function He(){return{datasetNamespace:null,datasetName:null,path:null,embedding:null,query:null,promptTemplate:`Context information is below.
---------------------
${je}
---------------------
Given the context information and not prior knowledge, answer the query.
Query: ${Ct}
Answer: `,topK:10,windowSizeChunks:1}}function os(){const n=He(),{subscribe:e,set:l,update:t}=Ht(JSON.parse(JSON.stringify(n)));return{subscribe:e,set:l,update:t,reset:()=>{l(JSON.parse(JSON.stringify(n)))},setDatasetPathEmbedding:(a,i,r)=>{t(c=>(a==null?(c.datasetNamespace=null,c.datasetName=null):(c.datasetNamespace=a.namespace,c.datasetName=a.name),c.path=i,c.embedding=r,c))},setQuestion:a=>{t(i=>(i.query=a,i))}}}function is(n){At(Je,n)}function Ft(){if(!Ot(Je))throw new Error("RagViewContext not found");return zt(Je)}function us(n){let e,l;return e=new rs({props:{value:n[0]||void 0,placeholder:"Enter a prompt template...",rows:12,class:"mb-2 w-full"}}),e.$on("input",n[4]),{c(){K(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){M(e,t,s),l=!0},p(t,s){const a={};s&1&&(a.value=t[0]||void 0),e.$set(a)},i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){U(e,t)}}}function cs(n){let e,l,t,s,a,i;return e=new Qt({props:{title:"Edit prompt template"}}),t=new Wt({props:{hasForm:!0,$$slots:{default:[us]},$$scope:{ctx:n}}}),a=new Yt({props:{primaryButtonText:"Save",secondaryButtonText:"Close",primaryButtonDisabled:!1}}),a.$on("click:button--secondary",n[10]),{c(){K(e.$$.fragment),l=C(),K(t.$$.fragment),s=C(),K(a.$$.fragment)},l(r){L(e.$$.fragment,r),l=F(r),L(t.$$.fragment,r),s=F(r),L(a.$$.fragment,r)},m(r,c){M(e,r,c),T(r,l,c),M(t,r,c),T(r,s,c),M(a,r,c),i=!0},p(r,c){const g={};c&16385&&(g.$$scope={dirty:c,ctx:r}),t.$set(g)},i(r){i||(x(e.$$.fragment,r),x(t.$$.fragment,r),x(a.$$.fragment,r),i=!0)},o(r){S(e.$$.fragment,r),S(t.$$.fragment,r),S(a.$$.fragment,r),i=!1},d(r){U(e,r),r&&o(l),U(t,r),r&&o(s),U(a,r)}}}function fs(n){let e,l,t,s,a,i;return a=new Xt({props:{open:n[1],$$slots:{default:[cs]},$$scope:{ctx:n}}}),a.$on("submit",n[5]),a.$on("close",n[11]),{c(){e=d("div"),l=d("div"),t=A(n[2]),s=C(),K(a.$$.fragment),this.h()},l(r){e=p(r,"DIV",{class:!0});var c=h(e);l=p(c,"DIV",{class:!0});var g=h(l);t=O(g,n[2]),g.forEach(o),c.forEach(o),s=F(r),L(a.$$.fragment,r),this.h()},h(){f(l,"class","h-96 w-full overflow-y-scroll whitespace-break-spaces font-mono leading-6"),f(e,"class","flex h-full w-full flex-col overflow-y-scroll")},m(r,c){T(r,e,c),u(e,l),u(l,t),T(r,s,c),M(a,r,c),i=!0},p(r,[c]){(!i||c&4)&&he(t,r[2]);const g={};c&2&&(g.open=r[1]),c&16387&&(g.$$scope={dirty:c,ctx:r}),a.$set(g)},i(r){i||(x(a.$$.fragment,r),i=!0)},o(r){S(a.$$.fragment,r),i=!1},d(r){r&&o(e),r&&o(s),U(a,r)}}}function ds(n,e,l){let t,s,a,{questionInputText:i}=e,{retrievalResults:r}=e;const c=Ft();Ye(n,c,m=>l(9,a=m));const g=Tt();let D=!1,y="";function N(m,B){return y.replace(Ct,m).replace(je,B)}function k(m){l(0,y=m.target.value)}function _(){l(1,D=!1)}const b=()=>{close(),l(1,D=!1)},I=()=>l(1,D=!1);return n.$$set=m=>{"questionInputText"in m&&l(6,i=m.questionInputText),"retrievalResults"in m&&l(7,r=m.retrievalResults)},n.$$.update=()=>{n.$$.dirty&512&&a.promptTemplate!=null&&l(0,y=a.promptTemplate),n.$$.dirty&128&&l(8,t=r==null?je:r.map(m=>m.text).join(`
`)),n.$$.dirty&320&&l(2,s=N(i,t)),n.$$.dirty&641&&r!=null&&a.query!=null&&g("promptTemplate",y)},[y,D,s,c,k,_,i,r,t,a,b,I]}class ps extends Xe{constructor(e){super(),Qe(this,e,ds,fs,We,{questionInputText:6,retrievalResults:7})}}const Pt="rag",hs=Rt(qt.retrieval,Pt),ms=Rt(qt.generate,Pt);function Et(n,e,l){const t=n.slice();t[9]=e[l];const s=t[9].match_spans[0];t[10]=s;const a=t[9].text.slice(0,t[10].start);t[11]=a;const i=t[9].text.slice(t[10].end);t[12]=i;const r=t[9].text.slice(t[10].start,t[10].end);return t[13]=r,t}function It(n){let e,l;return e=new Pe({props:{lines:n[1].topK}}),{c(){K(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){M(e,t,s),l=!0},p(t,s){const a={};s&2&&(a.lines=t[1].topK),e.$set(a)},i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){U(e,t)}}}function Vt(n){let e,l=n[0].data,t=[];for(let s=0;s<l.length;s+=1)t[s]=yt(Et(n,l,s));return{c(){e=d("div");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=p(s,"DIV",{class:!0});var a=h(e);for(let i=0;i<t.length;i+=1)t[i].l(a);a.forEach(o),this.h()},h(){f(e,"class","flex h-96 flex-col overflow-y-scroll")},m(s,a){T(s,e,a);for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(e,null)},p(s,a){if(a&1){l=s[0].data;let i;for(i=0;i<l.length;i+=1){const r=Et(s,l,i);t[i]?t[i].p(r,a):(t[i]=yt(r),t[i].c(),t[i].m(e,null))}for(;i<t.length;i+=1)t[i].d(1);t.length=l.length}},d(s){s&&o(e),Kt(t,s)}}}function xt(n){let e,l=n[11]+"",t;return{c(){e=d("span"),t=A(l),this.h()},l(s){e=p(s,"SPAN",{class:!0});var a=h(e);t=O(a,l),a.forEach(o),this.h()},h(){f(e,"class","whitespace-break-spaces")},m(s,a){T(s,e,a),u(e,t)},p(s,a){a&1&&l!==(l=s[11]+"")&&he(t,l)},d(s){s&&o(e)}}}function Dt(n){let e,l=n[12]+"",t;return{c(){e=d("span"),t=A(l),this.h()},l(s){e=p(s,"SPAN",{class:!0});var a=h(e);t=O(a,l),a.forEach(o),this.h()},h(){f(e,"class","whitespace-break-spaces")},m(s,a){T(s,e,a),u(e,t)},p(s,a){a&1&&l!==(l=s[12]+"")&&he(t,l)},d(s){s&&o(e)}}}function yt(n){let e,l,t,s=n[9].score.toFixed(2)+"",a,i,r,c,g,D=n[13]+"",y,N,k,_=n[11]!=""&&xt(n),b=n[12]!=""&&Dt(n);return{c(){e=d("div"),l=d("div"),t=d("span"),a=A(s),i=C(),r=d("div"),_&&_.c(),c=C(),g=d("span"),y=A(D),N=C(),b&&b.c(),k=C(),this.h()},l(I){e=p(I,"DIV",{class:!0});var m=h(e);l=p(m,"DIV",{class:!0});var B=h(l);t=p(B,"SPAN",{class:!0});var H=h(t);a=O(H,s),H.forEach(o),B.forEach(o),i=F(m),r=p(m,"DIV",{class:!0});var $=h(r);_&&_.l($),c=F($),g=p($,"SPAN",{class:!0});var E=h(g);y=O(E,D),E.forEach(o),N=F($),b&&b.l($),$.forEach(o),k=F(m),m.forEach(o),this.h()},h(){f(t,"class","px-0.5"),qe(t,"background-color",Ce(n[9].score)),f(l,"class","w-16"),f(g,"class","whitespace-break-spaces"),qe(g,"background-color",Ce(n[9].score)),f(r,"class","grow"),f(e,"class","flex flex-row gap-x-2 border-b border-b-neutral-200 py-2 text-sm")},m(I,m){T(I,e,m),u(e,l),u(l,t),u(t,a),u(e,i),u(e,r),_&&_.m(r,null),u(r,c),u(r,g),u(g,y),u(r,N),b&&b.m(r,null),u(e,k)},p(I,m){m&1&&s!==(s=I[9].score.toFixed(2)+"")&&he(a,s),m&1&&qe(t,"background-color",Ce(I[9].score)),I[11]!=""?_?_.p(I,m):(_=xt(I),_.c(),_.m(r,c)):_&&(_.d(1),_=null),m&1&&D!==(D=I[13]+"")&&he(y,D),m&1&&qe(g,"background-color",Ce(I[9].score)),I[12]!=""?b?b.p(I,m):(b=Dt(I),b.c(),b.m(r,null)):b&&(b.d(1),b=null)},d(I){I&&o(e),_&&_.d(),b&&b.d()}}}function _s(n){var z,ne;let e,l,t,s,a,i,r,c,g,D,y,N,k,_,b,I,m,B,H,$=((z=n[0])==null?void 0:z.isFetching)&&It(n),E=((ne=n[0])==null?void 0:ne.data)!=null&&Vt(n);return{c(){e=d("div"),l=d("div"),t=d("div"),s=d("span"),a=A("Chunk window"),i=C(),r=d("input"),c=C(),g=d("div"),D=d("span"),y=A("Top K"),N=C(),k=d("input"),_=C(),b=d("div"),$&&$.c(),I=C(),E&&E.c(),this.h()},l(w){e=p(w,"DIV",{class:!0});var q=h(e);l=p(q,"DIV",{class:!0});var J=h(l);t=p(J,"DIV",{});var j=h(t);s=p(j,"SPAN",{class:!0});var te=h(s);a=O(te,"Chunk window"),te.forEach(o),i=F(j),r=p(j,"INPUT",{type:!0,class:!0,min:!0,max:!0}),j.forEach(o),c=F(J),g=p(J,"DIV",{});var V=h(g);D=p(V,"SPAN",{class:!0});var X=h(D);y=O(X,"Top K"),X.forEach(o),N=F(V),k=p(V,"INPUT",{type:!0,class:!0}),V.forEach(o),J.forEach(o),q.forEach(o),_=F(w),b=p(w,"DIV",{class:!0});var Q=h(b);$&&$.l(Q),I=F(Q),E&&E.l(Q),Q.forEach(o),this.h()},h(){f(s,"class","mr-2"),f(r,"type","number"),f(r,"class","w-16 px-2"),f(r,"min","0"),f(r,"max","10"),f(D,"class","mr-2"),f(k,"type","number"),f(k,"class","w-16 px-2"),f(l,"class","flex h-4 flex-row gap-x-4 font-normal"),f(e,"class","mb-4 flex w-full flex-row justify-between"),f(b,"class","mb-8 h-full")},m(w,q){T(w,e,q),u(e,l),u(l,t),u(t,s),u(s,a),u(t,i),u(t,r),Re(r,n[1].windowSizeChunks),u(l,c),u(l,g),u(g,D),u(D,y),u(g,N),u(g,k),Re(k,n[1].topK),T(w,_,q),T(w,b,q),$&&$.m(b,null),u(b,I),E&&E.m(b,null),m=!0,B||(H=[Be(r,"input",n[6]),Be(k,"input",n[7])],B=!0)},p(w,[q]){var J,j;q&2&&Fe(r.value)!==w[1].windowSizeChunks&&Re(r,w[1].windowSizeChunks),q&2&&Fe(k.value)!==w[1].topK&&Re(k,w[1].topK),(J=w[0])!=null&&J.isFetching?$?($.p(w,q),q&1&&x($,1)):($=It(w),$.c(),x($,1),$.m(b,I)):$&&(Ee(),S($,1,1,()=>{$=null}),Ie()),((j=w[0])==null?void 0:j.data)!=null?E?E.p(w,q):(E=Vt(w),E.c(),E.m(b,null)):E&&(E.d(1),E=null)},i(w){m||(x($),m=!0)},o(w){S($),m=!1},d(w){w&&o(e),w&&o(_),w&&o(b),$&&$.d(),E&&E.d(),B=!1,Gt(H)}}}function vs(n,e,l){let t,s,a=P,i=()=>(a(),a=Nt(t,_=>l(0,s=_)),t),r;n.$$.on_destroy.push(()=>a());let{retrievalResults:c=void 0}=e;const g=Ft();Ye(n,g,_=>l(1,r=_));let{isFetching:D=!1}=e;const y=Tt();function N(){r.windowSizeChunks=Fe(this.value),g.set(r)}function k(){r.topK=Fe(this.value),g.set(r)}return n.$$set=_=>{"retrievalResults"in _&&l(4,c=_.retrievalResults),"isFetching"in _&&l(5,D=_.isFetching)},n.$$.update=()=>{n.$$.dirty&2&&i(l(2,t=r.datasetNamespace!=null&&r.datasetName!=null&&r.embedding!=null&&r.query!=null&&r.path!=null&&r.topK!=null&&r.windowSizeChunks!=null?hs({dataset_namespace:r.datasetNamespace,dataset_name:r.datasetName,embedding:r.embedding,query:r.query,path:r.path,chunk_window:r.windowSizeChunks,top_k:r.topK}):null)),n.$$.dirty&1&&l(5,D=(s==null?void 0:s.isFetching)??!1),n.$$.dirty&1&&l(4,c=s==null?void 0:s.data),n.$$.dirty&1&&(s==null?void 0:s.data)!=null&&!(s!=null&&s.isStale)&&y("results",s==null?void 0:s.data)},[s,r,t,g,c,D,N,k]}class gs extends Xe{constructor(e){super(),Qe(this,e,vs,_s,We,{retrievalResults:4,isFetching:5})}}function bs(n){let e,l;return{c(){e=d("div"),l=A("Press enter to answer the question."),this.h()},l(t){e=p(t,"DIV",{class:!0});var s=h(e);l=O(s,"Press enter to answer the question."),s.forEach(o),this.h()},h(){f(e,"class","whitespace-break-spaces font-light italic leading-5")},m(t,s){T(t,e,s),u(e,l)},p:P,i:P,o:P,d(t){t&&o(e)}}}function $s(n){let e,l,t;return l=new as({props:{source:n[11]}}),{c(){e=d("div"),K(l.$$.fragment),this.h()},l(s){e=p(s,"DIV",{class:!0});var a=h(e);L(l.$$.fragment,a),a.forEach(o),this.h()},h(){f(e,"class","markdown whitespace-break-spaces leading-5 svelte-dmtvg5")},m(s,a){T(s,e,a),M(l,e,null),t=!0},p(s,a){const i={};a&2048&&(i.source=s[11]),l.$set(i)},i(s){t||(x(l.$$.fragment,s),t=!0)},o(s){S(l.$$.fragment,s),t=!1},d(s){s&&o(e),U(l)}}}function ws(n){let e,l;return e=new Pe({}),{c(){K(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){M(e,t,s),l=!0},p:P,i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){U(e,t)}}}function ks(n){let e,l;return{c(){e=d("div"),l=A("None"),this.h()},l(t){e=p(t,"DIV",{class:!0});var s=h(e);l=O(s,"None"),s.forEach(o),this.h()},h(){f(e,"class","text-right italic")},m(t,s){T(t,e,s),u(e,l)},p:P,i:P,o:P,d(t){t&&o(e)}}}function Es(n){let e,l=n[12].toLocaleString()+"",t;return{c(){e=d("div"),t=A(l),this.h()},l(s){e=p(s,"DIV",{class:!0});var a=h(e);t=O(a,l),a.forEach(o),this.h()},h(){f(e,"class","text-right")},m(s,a){T(s,e,a),u(e,t)},p(s,a){a&4096&&l!==(l=s[12].toLocaleString()+"")&&he(t,l)},i:P,o:P,d(s){s&&o(e)}}}function Is(n){let e,l,t;return l=new Pe({}),{c(){e=d("div"),K(l.$$.fragment),this.h()},l(s){e=p(s,"DIV",{class:!0});var a=h(e);L(l.$$.fragment,a),a.forEach(o),this.h()},h(){f(e,"class","w-8")},m(s,a){T(s,e,a),M(l,e,null),t=!0},p:P,i(s){t||(x(l.$$.fragment,s),t=!0)},o(s){S(l.$$.fragment,s),t=!1},d(s){s&&o(e),U(l)}}}function Vs(n){let e,l;return{c(){e=d("div"),l=A("None"),this.h()},l(t){e=p(t,"DIV",{class:!0});var s=h(e);l=O(s,"None"),s.forEach(o),this.h()},h(){f(e,"class","text-right italic")},m(t,s){T(t,e,s),u(e,l)},p:P,i:P,o:P,d(t){t&&o(e)}}}function xs(n){let e,l=n[13].toLocaleString()+"",t;return{c(){e=d("div"),t=A(l),this.h()},l(s){e=p(s,"DIV",{class:!0});var a=h(e);t=O(a,l),a.forEach(o),this.h()},h(){f(e,"class","text-right")},m(s,a){T(s,e,a),u(e,t)},p(s,a){a&8192&&l!==(l=s[13].toLocaleString()+"")&&he(t,l)},i:P,o:P,d(s){s&&o(e)}}}function Ds(n){let e,l,t;return l=new Pe({}),{c(){e=d("div"),K(l.$$.fragment),this.h()},l(s){e=p(s,"DIV",{class:!0});var a=h(e);L(l.$$.fragment,a),a.forEach(o),this.h()},h(){f(e,"class","w-8")},m(s,a){T(s,e,a),M(l,e,null),t=!0},p:P,i(s){t||(x(l.$$.fragment,s),t=!0)},o(s){S(l.$$.fragment,s),t=!1},d(s){s&&o(e),U(l)}}}function ys(n){let e,l,t;return{c(){e=d("div"),l=d("div"),t=A("Retrieval"),this.h()},l(s){e=p(s,"DIV",{slot:!0,class:!0});var a=h(e);l=p(a,"DIV",{class:!0});var i=h(l);t=O(i,"Retrieval"),i.forEach(o),a.forEach(o),this.h()},h(){f(l,"class","font-medium"),f(e,"slot","above"),f(e,"class","flex flex-row gap-x-12")},m(s,a){T(s,e,a),u(e,l),u(l,t)},p:P,d(s){s&&o(e)}}}function Ss(n){let e,l,t,s;function a(r){n[19](r)}let i={};return n[10]!==void 0&&(i.isFetching=n[10]),l=new gs({props:i}),Mt.push(()=>Ut(l,"isFetching",a)),l.$on("results",n[20]),{c(){e=d("div"),K(l.$$.fragment),this.h()},l(r){e=p(r,"DIV",{slot:!0});var c=h(e);L(l.$$.fragment,c),c.forEach(o),this.h()},h(){f(e,"slot","below")},m(r,c){T(r,e,c),M(l,e,null),s=!0},p(r,c){const g={};!t&&c&1024&&(t=!0,g.isFetching=r[10],Bt(()=>t=!1)),l.$set(g)},i(r){s||(x(l.$$.fragment,r),s=!0)},o(r){S(l.$$.fragment,r),s=!1},d(r){r&&o(e),U(l)}}}function Ts(n){let e,l,t;return{c(){e=d("div"),l=d("div"),t=A("Generation"),this.h()},l(s){e=p(s,"DIV",{slot:!0,class:!0});var a=h(e);l=p(a,"DIV",{class:!0});var i=h(l);t=O(i,"Generation"),i.forEach(o),a.forEach(o),this.h()},h(){f(l,"class","font-medium"),f(e,"slot","above"),f(e,"class","flex flex-row gap-x-12")},m(s,a){T(s,e,a),u(e,l),u(l,t)},p:P,d(s){s&&o(e)}}}function Ns(n){let e,l,t;return l=new ps({props:{questionInputText:n[0],retrievalResults:n[1]}}),l.$on("promptTemplate",n[22]),{c(){e=d("div"),K(l.$$.fragment),this.h()},l(s){e=p(s,"DIV",{slot:!0});var a=h(e);L(l.$$.fragment,a),a.forEach(o),this.h()},h(){f(e,"slot","below")},m(s,a){T(s,e,a),M(l,e,null),t=!0},p(s,a){const i={};a&1&&(i.questionInputText=s[0]),a&2&&(i.retrievalResults=s[1]),l.$set(i)},i(s){t||(x(l.$$.fragment,s),t=!0)},o(s){S(l.$$.fragment,s),t=!1},d(s){s&&o(e),U(l)}}}function Rs(n){let e,l,t,s,a,i,r,c,g,D,y,N,k,_,b,I,m,B,H,$,E,z,ne,w,q,J,j,te,V,X,Q,pe,me,oe,le,_e,Ae,Oe,W,Y,ze,ae,ve,Ge,Ke,Z,ee,Le,ie,re,Me,ue,ge,Ue,Ze;_=new ns({props:{size:16}}),m=new ts({props:{value:n[0],size:"xl",disabled:n[5].datasetName==null,placeholder:n[5].datasetName!=null?"Enter a question":"Choose a dataset"}}),m.$on("input",n[15]),m.$on("change",n[16]);const et=[ws,$s,bs],ce=[];function tt(v,R){var G;return(G=v[4])!=null&&G.isFetching||v[10]?0:v[11]!=null?1:2}E=tt(n),z=ce[E]=et[E](n);const st=[Is,Es,ks],fe=[];function lt(v,R){var G;return(G=v[4])!=null&&G.isFetching||v[10]?0:v[12]!=null?1:2}W=lt(n),Y=fe[W]=st[W](n);const at=[Ds,xs,Vs],de=[];function rt(v,R){var G;return(G=v[4])!=null&&G.isFetching||v[10]?0:v[13]!=null?1:2}return Z=rt(n),ee=de[Z]=at[Z](n),re=new $t({props:{expanded:!0,$$slots:{below:[Ss],above:[ys]},$$scope:{ctx:n}}}),re.$on("results",n[21]),ue=new $t({props:{$$slots:{below:[Ns],above:[Ts]},$$scope:{ctx:n}}}),{c(){e=d("div"),l=d("div"),t=d("div"),s=d("div"),a=d("div"),i=d("div"),r=d("div"),c=d("div"),g=A("Question"),D=C(),y=d("div"),N=d("div"),k=d("button"),K(_.$$.fragment),I=C(),K(m.$$.fragment),B=C(),H=d("div"),$=d("div"),z.c(),ne=C(),w=d("div"),q=d("div"),J=d("div"),j=d("div"),te=d("div"),V=d("div"),X=d("div"),Q=A("Editor"),pe=C(),me=d("div"),oe=d("div"),le=d("div"),_e=d("div"),Ae=A("Input tokens"),Oe=C(),Y.c(),ze=C(),ae=d("div"),ve=d("div"),Ge=A("Output tokens"),Ke=C(),ee.c(),Le=C(),ie=d("div"),K(re.$$.fragment),Me=C(),K(ue.$$.fragment),this.h()},l(v){e=p(v,"DIV",{class:!0});var R=h(e);l=p(R,"DIV",{class:!0});var G=h(l);t=p(G,"DIV",{class:!0});var se=h(t);s=p(se,"DIV",{class:!0});var be=h(s);a=p(be,"DIV",{class:!0});var $e=h(a);i=p($e,"DIV",{class:!0});var we=h(i);r=p(we,"DIV",{});var ke=h(r);c=p(ke,"DIV",{class:!0});var nt=h(c);g=O(nt,"Question"),nt.forEach(o),ke.forEach(o),we.forEach(o),$e.forEach(o),be.forEach(o),D=F(se),y=p(se,"DIV",{class:!0});var ot=h(y);N=p(ot,"DIV",{class:!0});var Ve=h(N);k=p(Ve,"BUTTON",{class:!0});var it=h(k);L(_.$$.fragment,it),it.forEach(o),I=F(Ve),L(m.$$.fragment,Ve),Ve.forEach(o),ot.forEach(o),B=F(se),H=p(se,"DIV",{class:!0});var ut=h(H);$=p(ut,"DIV",{});var ct=h($);z.l(ct),ct.forEach(o),ut.forEach(o),se.forEach(o),ne=F(G),w=p(G,"DIV",{class:!0});var xe=h(w);q=p(xe,"DIV",{});var De=h(q);J=p(De,"DIV",{class:!0});var ft=h(J);j=p(ft,"DIV",{class:!0});var dt=h(j);te=p(dt,"DIV",{class:!0});var pt=h(te);V=p(pt,"DIV",{});var ht=h(V);X=p(ht,"DIV",{class:!0});var mt=h(X);Q=O(mt,"Editor"),mt.forEach(o),ht.forEach(o),pt.forEach(o),dt.forEach(o),ft.forEach(o),pe=F(De),me=p(De,"DIV",{class:!0});var _t=h(me);oe=p(_t,"DIV",{class:!0});var ye=h(oe);le=p(ye,"DIV",{class:!0});var Se=h(le);_e=p(Se,"DIV",{class:!0});var vt=h(_e);Ae=O(vt,"Input tokens"),vt.forEach(o),Oe=F(Se),Y.l(Se),Se.forEach(o),ze=F(ye),ae=p(ye,"DIV",{class:!0});var Te=h(ae);ve=p(Te,"DIV",{class:!0});var gt=h(ve);Ge=O(gt,"Output tokens"),gt.forEach(o),Ke=F(Te),ee.l(Te),Te.forEach(o),ye.forEach(o),_t.forEach(o),De.forEach(o),Le=F(xe),ie=p(xe,"DIV",{class:!0});var Ne=h(ie);L(re.$$.fragment,Ne),Me=F(Ne),L(ue.$$.fragment,Ne),Ne.forEach(o),xe.forEach(o),G.forEach(o),R.forEach(o),this.h()},h(){f(c,"class","px-6 py-3"),f(i,"class","bg-neutral-100 text-xs uppercase text-gray-700"),f(a,"class","w-full text-left text-sm text-gray-500 rtl:text-right"),f(s,"class","relative overflow-x-auto rounded-t-xl"),f(k,"class","z-10 -mr-10 mb-2"),k.disabled=b=n[5].datasetName==null,bt(k,"opacity-10",n[5].datasetName==null),f(N,"class","question-input flex w-full flex-row items-end"),f(y,"class","mx-6 mt-2 flex flex-col gap-y-4"),f(H,"class","mx-6 mb-4 mt-4 flex flex-col gap-y-4"),f(t,"class","flex h-fit w-1/2 flex-col gap-y-4 rounded-xl border border-gray-300"),f(X,"class","px-6 py-3"),f(te,"class","bg-gray-100 text-xs uppercase text-gray-700"),f(j,"class","w-full text-left text-sm text-gray-500 rtl:text-right"),f(J,"class","relative overflow-x-auto rounded-t-xl"),f(_e,"class","w-48 px-6 text-gray-900 backdrop:whitespace-nowrap"),f(le,"class","flex flex-row bg-white"),f(ve,"class","w-48 whitespace-nowrap px-6 text-gray-900"),f(ae,"class","flex flex-row bg-white"),f(oe,"class","mt-4 flex flex-col gap-y-2 text-left text-sm text-gray-500 rtl:text-right"),f(me,"class","relative w-full overflow-x-auto rounded-xl"),f(ie,"class","mx-4 mb-4 flex flex-col gap-y-4"),f(w,"class","flex w-1/2 flex-col gap-y-4 rounded-xl border border-gray-300"),f(l,"class","mx-4 mb-8 mt-8 flex flex-row gap-x-8 px-4"),f(e,"class","flex-grow overflow-y-scroll")},m(v,R){T(v,e,R),u(e,l),u(l,t),u(t,s),u(s,a),u(a,i),u(i,r),u(r,c),u(c,g),u(t,D),u(t,y),u(y,N),u(N,k),M(_,k,null),u(N,I),M(m,N,null),u(t,B),u(t,H),u(H,$),ce[E].m($,null),u(l,ne),u(l,w),u(w,q),u(q,J),u(J,j),u(j,te),u(te,V),u(V,X),u(X,Q),u(q,pe),u(q,me),u(me,oe),u(oe,le),u(le,_e),u(_e,Ae),u(le,Oe),fe[W].m(le,null),u(oe,ze),u(oe,ae),u(ae,ve),u(ve,Ge),u(ae,Ke),de[Z].m(ae,null),u(w,Le),u(w,ie),M(re,ie,null),u(ie,Me),M(ue,ie,null),ge=!0,Ue||(Ze=Be(k,"click",n[18]),Ue=!0)},p(v,R){(!ge||R&32&&b!==(b=v[5].datasetName==null))&&(k.disabled=b),(!ge||R&32)&&bt(k,"opacity-10",v[5].datasetName==null);const G={};R&1&&(G.value=v[0]),R&32&&(G.disabled=v[5].datasetName==null),R&32&&(G.placeholder=v[5].datasetName!=null?"Enter a question":"Choose a dataset"),m.$set(G);let se=E;E=tt(v),E===se?ce[E].p(v,R):(Ee(),S(ce[se],1,1,()=>{ce[se]=null}),Ie(),z=ce[E],z?z.p(v,R):(z=ce[E]=et[E](v),z.c()),x(z,1),z.m($,null));let be=W;W=lt(v),W===be?fe[W].p(v,R):(Ee(),S(fe[be],1,1,()=>{fe[be]=null}),Ie(),Y=fe[W],Y?Y.p(v,R):(Y=fe[W]=st[W](v),Y.c()),x(Y,1),Y.m(le,null));let $e=Z;Z=rt(v),Z===$e?de[Z].p(v,R):(Ee(),S(de[$e],1,1,()=>{de[$e]=null}),Ie(),ee=de[Z],ee?ee.p(v,R):(ee=de[Z]=at[Z](v),ee.c()),x(ee,1),ee.m(ae,null));const we={};R&16778242&&(we.$$scope={dirty:R,ctx:v}),re.$set(we);const ke={};R&16777223&&(ke.$$scope={dirty:R,ctx:v}),ue.$set(ke)},i(v){ge||(x(_.$$.fragment,v),x(m.$$.fragment,v),x(z),x(Y),x(ee),x(re.$$.fragment,v),x(ue.$$.fragment,v),ge=!0)},o(v){S(_.$$.fragment,v),S(m.$$.fragment,v),S(z),S(Y),S(ee),S(re.$$.fragment,v),S(ue.$$.fragment,v),ge=!1},d(v){v&&o(e),U(_),U(m),ce[E].d(),fe[W].d(),de[Z].d(),U(re),U(ue),Ue=!1,Ze()}}}function qs(n){let e,l;return{c(){e=d("div"),l=A("Retrieval Augmented Generation (RAG)"),this.h()},l(t){e=p(t,"DIV",{slot:!0,class:!0});var s=h(e);l=O(s,"Retrieval Augmented Generation (RAG)"),s.forEach(o),this.h()},h(){f(e,"slot","header-subtext"),f(e,"class","text-lg")},m(t,s){T(t,e,s),u(e,l)},p:P,d(t){t&&o(e)}}}function St(n){let e,l;return e=new Jt({props:{inputSize:"sm",dataset:n[7],path:n[8],embedding:n[9]}}),e.$on("change",n[17]),{c(){K(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){M(e,t,s),l=!0},p(t,s){const a={};s&128&&(a.dataset=t[7]),s&256&&(a.path=t[8]),s&512&&(a.embedding=t[9]),e.$set(a)},i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){U(e,t)}}}function Cs(n){let e,l,t=n[6]&&St(n);return{c(){e=d("div"),t&&t.c(),this.h()},l(s){e=p(s,"DIV",{slot:!0,class:!0});var a=h(e);t&&t.l(a),a.forEach(o),this.h()},h(){f(e,"slot","header-right"),f(e,"class","dataset-selector py-2 svelte-dmtvg5")},m(s,a){T(s,e,a),t&&t.m(e,null),l=!0},p(s,a){s[6]?t?(t.p(s,a),a&64&&x(t,1)):(t=St(s),t.c(),x(t,1),t.m(e,null)):t&&(Ee(),S(t,1,1,()=>{t=null}),Ie())},i(s){l||(x(t),l=!0)},o(s){S(t),l=!1},d(s){s&&o(e),t&&t.d()}}}function Fs(n){let e,l;return e=new jt({props:{hideTasks:!0,$$slots:{"header-right":[Cs],"header-subtext":[qs],default:[Rs]},$$scope:{ctx:n}}}),{c(){K(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){M(e,t,s),l=!0},p(t,[s]){const a={};s&16793591&&(a.$$scope={dirty:s,ctx:t}),e.$set(a)},i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){U(e,t)}}}const Ps="";function As(n,e,l){let t,s,a=P,i=()=>(a(),a=Nt(t,V=>l(4,s=V)),t),r;n.$$.on_destroy.push(()=>a());const c=os();Ye(n,c,V=>l(5,r=V)),is(c);const g=Zt();let D=!1;es("rag",Ps,c,g,V=>ls(V,He()),V=>ss(V,He()),()=>{l(6,D=!0)});let y,N,k,_="",b,I=!1,m,B=null,H=null,$=null;function E(V){l(11,B=null),l(1,b=void 0),l(0,_=`${V.detail}`)}function z(){c.setQuestion(_)}const ne=V=>{const{dataset:X,path:Q,embedding:pe}=V.detail;(X!=y||Q!=N||pe!=k)&&(l(7,y=X),l(8,N=Q),l(9,k=pe),c.setDatasetPathEmbedding(X,Q,pe))},w=()=>z();function q(V){I=V,l(10,I)}const J=V=>l(1,b=V.detail);function j(V){Lt.call(this,n,V)}const te=V=>{l(2,m=V.detail)};return n.$$.update=()=>{n.$$.dirty&32&&(r.datasetNamespace!=null&&r.datasetName!=null&&l(7,y={namespace:r.datasetNamespace,name:r.datasetName}),r.path!=null&&l(8,N=r.path),r.embedding!=null&&l(9,k=r.embedding)),n.$$.dirty&32&&r.query!=null&&l(0,_=r.query),n.$$.dirty&7&&i(l(3,t=_!=null&&m!=null&&b!=null?ms({query:_,prompt_template:m,retrieval_results:b}):null)),n.$$.dirty&24&&t!=null&&(s==null?void 0:s.data)!=null&&!s.isFetching&&!s.isStale&&(l(11,B=s.data.result),l(12,H=s.data.num_input_tokens),l(13,$=s.data.num_output_tokens))},[_,b,m,t,s,r,D,y,N,k,I,B,H,$,c,E,z,ne,w,q,J,j,te]}class Bs extends Xe{constructor(e){super(),Qe(this,e,As,Fs,We,{})}}export{Bs as component};
