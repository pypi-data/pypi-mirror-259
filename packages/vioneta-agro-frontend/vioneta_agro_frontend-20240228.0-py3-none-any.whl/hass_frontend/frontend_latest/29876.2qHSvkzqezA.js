export const id=29876;export const ids=[29876];export const modules={28611:(t,e,a)=>{a.a(t,(async(t,s)=>{try{a.d(e,{U:()=>p});var i=a(63780),n=a(40569),o=a(52720),d=a(31656),r=a(6600),c=a(75192),h=a(98611),l=t([c,h]);function u(t,e){let a=new Date(e);return t>2&&0===a.getHours()&&(a=(0,i.c)(a,1)),a.setMinutes(0,0,0),t>35&&a.setDate(1),t>2&&a.setHours(0),a.getTime()}function p(t,e,a,s,i,l,p){const _=(0,n.c)(e,t),m=void 0!==l&&void 0!==p;if(m&&_<=35){const a=(0,o.c)(e,t),s=(0,o.c)(p,l);s>a?e=(0,d.c)(e,s-a):a>s&&(p=(0,d.c)(p,a-s))}const k={parsing:!1,animation:!1,interaction:{mode:"x"},scales:{x:{type:"time",suggestedMin:t.getTime(),max:u(_,e),adapters:{date:{locale:a,config:s}},ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,font:t=>t.tick&&t.tick.major?{weight:"bold"}:{}},time:{tooltipFormat:_>35?"monthyear":_>7?"date":_>2?"weekday":_>0?"datetime":"hour",minUnit:_>35?"month":_>2?"day":"hour"}},y:{stacked:!0,type:"linear",title:{display:!0,text:i},ticks:{beginAtZero:!0,callback:t=>(0,r.iy)(Math.abs(t),a)}}},plugins:{tooltip:{position:"nearest",filter:t=>"0"!==t.formattedValue,itemSort:function(t,e){return e.datasetIndex-t.datasetIndex},callbacks:{title:t=>{if(_>0)return t[0].label;const e=new Date(t[0].parsed.x);return`${m?`${(0,c.Au)(e,a,s)}: `:""}${(0,h.AB)(e,a,s)} â€“ ${(0,h.AB)((0,d.c)(e,1),a,s)}`},label:t=>`${t.dataset.label}: ${(0,r.iy)(t.parsed.y,a)} ${i}`}},filler:{propagate:!1},legend:{display:!1,labels:{usePointStyle:!0}}},elements:{bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:50}},locale:(0,r.gz)(a)};return m&&(k.scales.xAxisCompare={...k.scales.x,suggestedMin:l.getTime(),max:u(_,p),display:!1}),k}[c,h]=l.then?(await l)():l,s()}catch(_){s(_)}}))},29876:(t,e,a)=>{a.a(t,(async(t,s)=>{try{a.r(e),a.d(e,{HuiEnergyDevicesDetailGraphCard:()=>g});var i=a(5576),n=a(98751),o=a(44124),d=a(84244),r=a(55736),c=a(52672),h=a(72092),l=a(65398),u=(a(13332),a(71132)),p=a(32012),_=a(81540),m=a(72268),k=a(28611),f=t([u,k]);[u,k]=f.then?(await f)():f;const y="kWh";let g=(0,i.c)([(0,r.Kx)("hui-energy-devices-detail-graph-card")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,r.qq)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,r.K2)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,r.K2)()],key:"_chartData",value:()=>({datasets:[]})},{kind:"field",decorators:[(0,r.K2)()],key:"_chartDatasetExtra",value:()=>[]},{kind:"field",decorators:[(0,r.K2)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,r.K2)()],key:"_start",value:()=>(0,n.c)()},{kind:"field",decorators:[(0,r.K2)()],key:"_end",value:()=>(0,o.c)()},{kind:"field",decorators:[(0,r.K2)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,r.K2)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,r.K2)()],key:"_hiddenStats",value:()=>new Set},{kind:"field",key:"hassSubscribeRequiredHostProps",value:()=>["_config"]},{kind:"method",key:"hassSubscribe",value:function(){var t;return[(0,u.uY)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((t=>{this._data=t,this._processStatistics()}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,m.eC)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"willUpdate",value:function(t){t.has("_hiddenStats")&&this._data&&this._processStatistics()}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?d.kP` <ha-card> ${this._config.title?d.kP`<h1 class="card-header">${this._config.title}</h1>`:""} <div class="content ${(0,c.m)({"has-header":!!this._config.title})}"> <ha-chart-base externalHidden .hass="${this.hass}" .data="${this._chartData}" .extraData="${this._chartDatasetExtra}" .options="${this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,y,this._compareStart,this._compareEnd)}" chart-type="bar" @dataset-hidden="${this._datasetHidden}" @dataset-unhidden="${this._datasetUnhidden}"></ha-chart-base> </div> </ha-card> `:d.qs}},{kind:"method",key:"_datasetHidden",value:function(t){t.stopPropagation(),this._hiddenStats.add(this._data.prefs.device_consumption[t.detail.index].stat_consumption),this.requestUpdate("_hiddenStats")}},{kind:"method",key:"_datasetUnhidden",value:function(t){t.stopPropagation(),this._hiddenStats.delete(this._data.prefs.device_consumption[t.detail.index].stat_consumption),this.requestUpdate("_hiddenStats")}},{kind:"field",key:"_createOptions",value:()=>(0,h.c)(((t,e,a,s,i,n,o)=>{const d=(0,k.U)(t,e,a,s,i,n,o);return{...d,interaction:{mode:"nearest"},plugins:{...d.plugins,legend:{display:!0,labels:{usePointStyle:!0}}}}}))},{kind:"method",key:"_processStatistics",value:function(){const t=this._data,e=t.stats,a=t.statsCompare,s={};t.prefs.device_consumption.forEach((t=>{const a=t.stat_consumption in e&&(0,p.Gi)(e[t.stat_consumption])||0;s[t.stat_consumption]=a}));const i=t.prefs.device_consumption.map((t=>t.stat_consumption));i.sort(((t,e)=>s[e]-s[t]));const n=[],d=[];n.push(...this._processDataSet(e,t.statsMetadata,t.prefs.device_consumption,i));const r=n.length;d.push(...Array(r).fill({})),a&&(n.push({order:0,data:[]}),d.push({show_legend:!1}),n.push({order:999,data:[],xAxisID:"xAxisCompare"}),d.push({show_legend:!1}),n.push(...this._processDataSet(a,t.statsMetadata,t.prefs.device_consumption,i,!0)),d.push(...Array(r).fill({show_legend:!1}))),this._start=t.start,this._end=t.end||(0,o.c)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare,this._chartData={datasets:n},this._chartDatasetExtra=d}},{kind:"method",key:"_processDataSet",value:function(t,e,a,s,i=!1){const n=[];return a.forEach(((a,o)=>{const d=(0,l.cx)(o);let r=null;const c=[];if(a.stat_consumption in t){const e=t[a.stat_consumption];let s;for(const t of e){if(null===t.change||void 0===t.change)continue;if(r===t.start)continue;const e=new Date(t.start);c.push({x:e.getTime(),y:t.change}),r=t.start,s=t.end}1===c.length&&c.push({x:s,y:0})}n.push({label:(0,p.aE)(this.hass,a.stat_consumption,e[a.stat_consumption]),hidden:this._hiddenStats.has(a.stat_consumption),borderColor:i?d+"7F":d,backgroundColor:i?d+"32":d+"7F",data:c,order:1+s.indexOf(a.stat_consumption),stack:"devices",pointStyle:!i&&"circle",xAxisID:i?"xAxisCompare":void 0})})),n}},{kind:"get",static:!0,key:"styles",value:function(){return d.gV`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}`}}]}}),(0,_.K)(d.oH));s()}catch(t){s(t)}}))}};
//# sourceMappingURL=29876.2qHSvkzqezA.js.map